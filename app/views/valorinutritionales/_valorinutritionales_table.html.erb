<section class="tabel-container">
<%= turbo_frame_tag "valorinutritionales_table" do %>
<h1>Valorile Nutriționale</h1>

<%= search_form_for @q, data: { turbo_frame: :results } do |f| %>
  <%= f.label "Cauta aliment" %>
  <%= f.search_field :aliment_cont,
                     oninput: 'this.form.requestSubmit()', autofocus: true, autocomplete: 'off' %>
<% end %></br>

  <table class="table table-striped table-bordered table-hover">
    <thead>
      <tr>
        <th>Nr.</th>
        <th>Aliment</th>
        <th>Calorii</th>
        <th>Proteine</th>
        <th>Lipide</th>
        <th>Carbohidrati</th>
        <th>Fibre</th>
        <th>Cantitate(g)</th>
      </tr>
    </thead>
    <tbody>
      <% @valorinutritionales.each do |valorinutritionale| %>
        <% selected_value = session[:selected_values]&.find { |v| v[:id] == valorinutritionale.id.to_s } %>
        <tr>
          <td><%= valorinutritionale.cod %></td>
          <td><%= valorinutritionale.aliment %></td>
          <td><%= valorinutritionale.calorii %></td>
          <td><%= valorinutritionale.proteine %></td>
          <td><%= valorinutritionale.lipide %></td>
          <td><%= valorinutritionale.carbohidrati %></td>
          <td><%= valorinutritionale.fibre %></td>
          <td>
         
          <%= form_with(url: select_valorinutritionales_valorinutritionales_path, method: :post, remote: true, data: { turbo_action: "replace" }, id: "select-form-#{valorinutritionale.id}") do |form| %>

          
            <%= form.hidden_field :id, value: valorinutritionale.id %>
            <%= form.number_field :value, min: 0, max: 1000, step: 0.1, value: selected_value&.dig(:value) || 0 %>
            <%= form.submit "Adaugă", class: "btn" %>
          <% end %>

          </td>
        </tr>
      <% end %>
    </tbody>
  </table>
  <%= paginate valorinutritionales, remote: true %>

<% end %>
</section>



