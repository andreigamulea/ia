<h1>Testare Conexiune Debian</h1>

<!-- Afișare cheie de criptare (doar pentru testare) -->
<p>Cheia de criptare: <%= @encryption_key %></p>

<video id="my-video" class="video-js vjs-default-skin" controls preload="auto" crossorigin="anonymous" width="640" height="360">
  <source src="<%= @video_url_m3u8 %>" type="application/x-mpegURL">
</video>

<!-- Canvas pentru afișarea filigranului -->
<canvas id="my-canvas" width="640" height="360" style="position: absolute; top: 0; left: 0; pointer-events: none;"></canvas>

<!-- Include stilurile și scripturile Video.js -->
<script src="https://vjs.zencdn.net/7.20.3/video.js"></script>
<link href="https://vjs.zencdn.net/7.20.3/video-js.css" rel="stylesheet" />

<script>
document.addEventListener('DOMContentLoaded', function() {
    var player = videojs('my-video', {
        controls: true,
        preload: 'auto',
        techOrder: ['html5']
    });

    var canvas = document.getElementById('container');
    var ctx = canvas.getContext('2d');
    var watermark = " ";

    function drawWatermark() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        ctx.font = '12px Arial';
        ctx.fillStyle = 'rgba(255, 0, 0, 0.5)';
        ctx.fillText(watermark, 0, 0);
    }

    function updateCanvas() {
        drawWatermark();
        if (!player.paused() && !player.ended()) {
            requestAnimationFrame(updateCanvas);
        }
    }

    player.on('play', function() {
        updateCanvas();
    });

    player.on('pause', function() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
    });

    player.on('ended', function() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
    });
});
</script>
