<style>
.action-buttons {
  display: flex;
  gap: 10px;
}
</style>
<div class="container" id="cvp1">
<%= render 'layouts/sideleft' %>

<div class="cr" style="background-color: aliceblue; ">


<div class="tbland">
<div class="tbr">

<h1 class="first-tittle">Documente - Ayush Cell Romania</h1>
<h2 class="main-title" >Documente</h2>

<p>Suntem bucuroși să vă oferim acces rapid și ușor la adeverința dumneavoastră de participare prin intermediul acestui serviciu specializat. Scopul nostru este de a vă oferi o experiență fără efort în obținerea acestui document, asigurându-vă astfel un sprijin consistent în cadrul demersurilor dumneavoastră educaționale și profesionale.</p>











    <div class="table-responsive" style="margin-right: auto; margin-left: 0;">
    <table class="table table-striped table-bordered table-hover">
        <thead class="thead-dark">
            <tr class="desk">
                <th>Servicii</th>
                <th>Detalii</th>
                <th>Cantitate</th>
                <th>Pret bucata</th>                
                <th>Pret total</th>
                <th>Actiune</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td> <%= @prod.nume %> </td>
                <td><%= @prod.detalii %></td>
                <td style="text-align:center;">
                    <select id="cantitateSelect" name="cantitate" class="form-control">
                        <% (1..50).each do |numar| %>
                            <option value="<%= numar %>"><%= numar %></option>
                        <% end %>
                    </select>
                </td>
                <td id="pretBucata" style="text-align:center;"><%= @prod.pret.to_f.round %>
                lei</td>                
                <td id="pretTotal" style="text-align:center;">---</td>
                <td style="text-align:center;"> <%= link_to 'Comanda', datefacturare_path(s: @prod.id), id: 'linkComanda', class: 'btn btn-primary', "data-turbo": "false" %>
                

                </td>


            </tr>
        </tbody>
    </table>

</div></div></div></div></div>

<script>
console.log("Script încărcat");
document.addEventListener("turbo:load", function() {
    console.log("Turbo load triggered");
    initComandaLink();
});

function initComandaLink() {
    updatePret();
    updateLink();

    document.getElementById('cantitateSelect').addEventListener('change', function() {
        updatePret();
        updateLink();
    });
}

function calculeazaPret(n) {
    var pretPeBucata = parseFloat(document.getElementById('pretBucata').textContent.replace(' lei', ''));
    return pretPeBucata * n;
}

function updatePret() {
    var cantitate = parseInt(document.getElementById('cantitateSelect').value, 10);
    var pretTotal = calculeazaPret(cantitate);

    document.getElementById('pretTotal').textContent = pretTotal.toFixed(0) + ' lei';
}

function updateLink() {
    console.log('Actualizare link comandă');
    var cantitate = document.getElementById('cantitateSelect').value;
    var pretPeBucata = parseFloat(document.getElementById('pretBucata').textContent.replace(' lei', ''));
    var pretTotal = parseFloat(document.getElementById('pretTotal').textContent.replace(' lei', ''));
    var link = document.getElementById('linkComanda');
    var baseUrl = link.href;

    let newUrl = new URL(baseUrl);
    newUrl.searchParams.set('cantitate', cantitate);
    newUrl.searchParams.set('pret_bucata', pretPeBucata.toFixed(2));
    newUrl.searchParams.set('pret_total', pretTotal.toFixed(2));

    link.href = newUrl.toString();
}
</script>
