<div class="container" id="cvp1">
<%= render 'layouts/sideleft' %>

<div class="cr" style="background-color: aliceblue; ">
    <form>
    <h1 style="text-align: center;">CERERE ÎNSCRIERE VOLUNTAR</h1>

        
        <label for="numar">Nr:</label>
        <input type="text" id="numar" name="numar"><br><br>

        <label for="nume">Numele:</label>
        <input type="text" id="nume" name="nume">
        <label for="prenume">și prenumele:</label>
        <input type="text" id="prenume" name="prenume"><br><br>

        <label>Adresa de domiciliu:</label><br>
        Str. <input type="text" name="strada">
        Nr. <input type="text" name="numar_casa" style="width: 50px;">
        Bl. <input type="text" name="bloc" style="width: 50px;">
        Sc. <input type="text" name="scara" style="width: 50px;">
        Et. <input type="text" name="etaj" style="width: 50px;">
        Apt. <input type="text" name="apartament" style="width: 50px;"><br><br>

        Localitatea: <input type="text" name="localitate">
        Județul: <input type="text" name="judet"><br><br>

        Telefon: <input type="text" name="telefon">
        E-mail: <input type="email" name="email"><br><br>

        
prin prezenta, vă solicit acordul de a participa în calitate de voluntar la activitățile de voluntariat organizate de organizația dvs.
Menționez că îmi asum toate obligațiile prevăzute în contractul de voluntariat și în fișa de voluntariat.
        <br><br>

        Data: <input type="date" name="data"><br><br>

        <div class="voluntar" style="text-align: right;">
        <p style="padding-left: 30px;">Voluntar: </p>
        <p style="margin-top:-15px;">
        <span id="nume-voluntar-destinatie" style="width: -webkit-fill-available; padding-left:5px;">
            
        </span>
        </p>
        <canvas id="signature-pad-3" width="auto" height="auto" style="border: 1px solid #000;"></canvas></br></br>
        <button type="button" onclick="clearSignature(2)", class="register">Șterge Semnătura</button>
    </div>

        <input type="submit" value="Trimite Cererea" class="register" style="border: 1px solid #4b0082; background-color: #4b0082;">

   
        </div>

        </div>

        <script>
        document.addEventListener("turbo:load", function() {
          initializeSignaturePad('signature-pad-3'); // Inițializează doar al doilea canvas
          
          var form = document.querySelector('form');
          form.addEventListener('submit', function() {
            saveSignatureOnSubmit('signature-pad-3', 'semnatura_voluntar'); // Folosește ID-ul corect al canvas-ului și câmpului ascuns
          });
          
          synchronizeFields('nume-voluntar-sursa',  'nume-voluntar-destinatie');
        });
        
        function synchronizeFields(sourceFieldId, targetElementId) {
            var sourceField = document.getElementById(sourceFieldId);
            var targetElement = document.getElementById(targetElementId);
        
            if (sourceField && targetElement) {
                sourceField.addEventListener('input', function() {
                    // Verifică dacă elementul țintă este un câmp de input sau alt tip de element
                    if ('value' in targetElement) {
                        // Pentru elemente de input, textarea, etc.
                        targetElement.value = sourceField.value;
                    } else {
                        // Pentru elemente non-input, cum ar fi span, div, etc.
                        targetElement.textContent = sourceField.value;
                    }
                });
            }
        }
        
        
        function saveSignatureOnSubmit(canvasId, hiddenFieldId) {
            var canvas = document.getElementById(canvasId);
            if (canvas) {
                var dataURL = canvas.toDataURL();
                document.getElementById(hiddenFieldId).value = dataURL; // Setează valoarea câmpului ascuns
            }
        }
        
        
        function initializeSignaturePad(canvasId) {
          var canvas = document.getElementById(canvasId);
          if (canvas) {
            var context = canvas.getContext('2d');
            var isDrawing = false;
        
            function startDrawing(event) {
              event.preventDefault(); // Împiedică derularea în timpul desenării
              isDrawing = true;
              var rect = canvas.getBoundingClientRect();
              var x = (event.clientX || event.touches[0].clientX) - rect.left;
              var y = (event.clientY || event.touches[0].clientY) - rect.top;
              context.beginPath();
              context.moveTo(x, y);
            }
        
            function continueDrawing(event) {
              event.preventDefault(); // Împiedică derularea în timpul desenării
              if (!isDrawing) return;
              var rect = canvas.getBoundingClientRect();
              var x = (event.clientX || event.touches[0].clientX) - rect.left;
              var y = (event.clientY || event.touches[0].clientY) - rect.top;
              context.lineTo(x, y);
              context.stroke();
            }
        
            function stopDrawing(event) {
              if (isDrawing) {
                event.preventDefault();  // Împiedică derularea și alte acțiuni implicite
                event.stopPropagation(); // Opriți propagarea evenimentului
                isDrawing = false;
              }
            }
        
            // Evenimente pentru mouse
            canvas.addEventListener('mousedown', startDrawing);
            canvas.addEventListener('mousemove', continueDrawing);
            canvas.addEventListener('mouseup', stopDrawing);
            canvas.addEventListener('mouseleave', stopDrawing);
        
            // Evenimente pentru touch (ecran tactil)
            canvas.addEventListener('touchstart', startDrawing);
            canvas.addEventListener('touchmove', continueDrawing);
            canvas.addEventListener('touchend', stopDrawing);
          }
        }
        
        
        function loadExistingSignature(canvasId) {
          var canvas = document.getElementById(canvasId);
          var context = canvas.getContext('2d');
          var existingSignature = "<%= @semnatura_admin %>";
        
          if (existingSignature) {
            var image = new Image();
            image.onload = function() {
              context.drawImage(image, 0, 0);
            };
            image.src = existingSignature;
          }
        }
        
        function saveSignature(padNumber) {
          var canvas = document.getElementById('signature-pad-3');
          var dataURL = canvas.toDataURL();
          console.log(dataURL);
          // Trimite dataURL la server
        }
        
        function clearSignature(padNumber) {
          var canvas = document.getElementById('signature-pad-3');
          var context = canvas.getContext('2d');
          context.clearRect(0, 0, canvas.width, canvas.height);
        }
        
        </script>
        
        